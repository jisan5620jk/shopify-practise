<div style="margin: 50px 120px;">
  <!-- ðŸ” Search Bar and Header -->
  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; margin-btotom: 30px;">
    <h2>Your Search Result</h2>
    <form action="{{ routes.search_url }}" style="display: flex; gap: 10px;">
      <input type="text" name="q" placeholder="Search..." value="{{ search.terms }}" style="padding: 5px;">
      <button type="submit">{% render 'icons', icon: 'search' %}</button>
    </form>
  </div>

  <!-- ðŸ‘‡ STEP 1: Set flags -->
  {% assign has_products = false %}
  {% assign has_articles = false %}
  {% assign has_pages = false %}

  <!-- ðŸ‘‡ STEP 2: Capture each group into a block -->
  {% capture product_cards %}
    {% for item in search.results %}
      {% case item.object_type %}
        {% when 'product' %}
          {% assign has_products = true %}
          <div>{% render 'product-card', product: item %}</div>
      {% endcase %}
    {% endfor %}
  {% endcapture %}

  {% capture article_cards %}
    {% for item in search.results %}
      {% if item.object_type == 'article' %}
        {% assign has_articles = true %}
        <div style="margin-bottom: 10px;">
          {%- render 'blog-card', article: item -%}
        </div>
      {% endif %}
    {% endfor %}
  {% endcapture %}

  {% capture page_cards %}
    {% for item in search.results %}
      {% if item.object_type == 'page' %}
        {% assign has_pages = true %}
        <div style="margin-bottom: 10px;">
          <a href="{{ item.url }}">{{ item.title }}</a>
        </div>
      {% endif %}
    {% endfor %}
  {% endcapture %}

  <!-- ðŸ‘‡ STEP 3: Render the blocks only if they exist -->
  {% if has_products %}
    <h3>Your search matched these products:</h3>
    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 40px;">
      {{ product_cards }}
    </div>
  {% endif %}

  {% if has_articles %}
    <h3>Articles</h3>
    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 40px;">
      {{ article_cards }}
    </div>
  {% endif %}

  {% if has_pages %}
    <h3>Pages</h3>
    <div style="margin-bottom: 40px;">
      {{ page_cards }}
    </div>
  {% endif %}

  <!-- ðŸ‘‡ STEP 4: Show fallback if no results -->
  {% if search.results.size == 0 %}
    <p>No results found for "{{ search.terms }}". Please check your spelling or try different keywords.</p>
  {% endif %}

</div>